<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <script
      type="text/javascript"
      src="https://cdnjs.cloudflare.com/ajax/libs/knockout/3.5.0/knockout-min.js"
    ></script>

    <title>Document</title>
  </head>
  <body>
    <h1 data-bind="text: category"></h1>
    <table>
      <thead>
        <tr>
          <td>Id</td>
          <td>Nome</td>
          <td>Marca</td>
          <td>Pre√ßo</td>
          <td>Foto</td>
        </tr>
      </thead>

      <tbody data-bind="foreach: products">
        <tr>
          <td data-bind="text: id"></td>
          <td data-bind="text: name"></td>
          <td data-bind="text: brand"></td>
          <td data-bind="text: price"></td>
          <td>
            <img data-bind="attr: {src : photos}" width="256" height="256" />
          </td>
        </tr>
      </tbody>
    </table>
    <script>
      let productList = {
        hostURL: "http://www.armazempb.com.br",
        products: [],
        category: "",
      };

      class ViewModel {
        constructor(productList) {
          this.category = ko.observable(productList.category);
          this.products = ko.observableArray(productList.products);
        }
      }

      fetch("data.json")
        .then((response) => response.json())
        .then((data) => {
          productList.category = data.category.displayName;
          for (let i = 0; i < data.items.length; i++) {
            productList.products.push({
              name: data.items[i].displayName,
              id: data.items[i].id,
              brand: data.items[i].brand,
              price: data.items[i].salePrice ?? data.items[i].listPrice,
              photos: productList.hostURL + data.items[i].mediumImageURLs[0],
            });
          }
          ko.applyBindings(new ViewModel(productList));
        });
    </script>
  </body>
</html>
